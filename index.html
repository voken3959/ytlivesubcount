<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced YouTube Live Sub Counter</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .search-section {
            margin-bottom: 30px;
        }
        
        .search-box {
            position: relative;
            margin-bottom: 20px;
        }
        
        .search-input {
            width: 100%;
            padding: 15px 60px 15px 20px;
            font-size: 16px;
            border: none;
            border-radius: 50px;
            background: rgba(255,255,255,0.9);
            color: #333;
        }
        
        .search-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: #667eea;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }
        
        .search-btn:hover {
            background: #5a6fd8;
        }
        
        .quick-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.2);
            color: white;
        }
        
        .btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: #667eea;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 450px;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .title {
                font-size: 2rem;
            }
        }
        
        .results-container {
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .channel-card {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .channel-card:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .channel-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .channel-info h3 {
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .channel-subs {
            opacity: 0.8;
            font-size: 0.9rem;
        }
        
        .counter-section {
            text-align: center;
        }
        
        .counter-display {
            margin: 20px 0;
        }
        
        .channel-name {
            font-size: 1.3rem;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .sub-count {
            font-size: 4rem;
            font-weight: 900;
            margin: 15px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .sub-count.increase {
            animation: increase 0.5s ease;
        }
        
        .sub-count.decrease {
            animation: decrease 0.5s ease;
        }
        
        @keyframes increase {
            0% { transform: scale(1); color: #fff; }
            50% { transform: scale(1.1); color: #4CAF50; }
            100% { transform: scale(1); color: #fff; }
        }
        
        @keyframes decrease {
            0% { transform: scale(1); color: #fff; }
            50% { transform: scale(1.1); color: #f44336; }
            100% { transform: scale(1); color: #fff; }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .milestone-section {
            margin: 25px 0;
            text-align: left;
        }
        
        .milestone-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .milestone {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .milestone.active {
            background: #4CAF50;
        }
        
        .milestone.triggered {
            background: #FF9800;
        }
        
        .milestone:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .history-section {
            margin-top: 20px;
        }
        
        .history-container {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 10px;
        }
        
        .history-item {
            padding: 8px;
            margin-bottom: 5px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .custom-input {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: white;
            margin-top: 10px;
        }
        
        .custom-input::placeholder {
            color: rgba(255,255,255,0.7);
        }
        
        h3, h4 {
            margin-bottom: 15px;
            opacity: 0.9;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üöÄ YouTube Live Counter</h1>
            <p class="subtitle">Real-time subscriber tracking with smart simulation</p>
        </div>

        <div class="card search-section">
            <div class="search-box">
                <input id="searchInput" class="search-input" placeholder="Search YouTube channels..." />
                <button id="searchBtn" class="search-btn">Search</button>
            </div>
            <div class="quick-actions">
                <button id="notifyBtn" class="btn">üîî Notifications</button>
                <button id="fullscreenBtn" class="btn">‚õ∂ Fullscreen</button>
                <button id="exportBtn" class="btn">üìä Export</button>
                <button id="themeBtn" class="btn">üé® Theme</button>
            </div>
        </div>

        <div class="grid">
            <div class="card">
                <h3>üîç Search Results</h3>
                <div id="results" class="results-container">
                    <div class="empty-state">
                        <p>Search for YouTube channels to get started!</p>
                    </div>
                </div>
            </div>

            <div class="card counter-section">
                <div class="counter-display">
                    <div id="channelName" class="channel-name">Select a channel</div>
                    <div id="subCount" class="sub-count">‚Äî</div>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div id="growthRate" class="stat-value">‚Äî</div>
                            <div class="stat-label">Growth/hr</div>
                        </div>
                        <div class="stat-item">
                            <div id="lastUpdate" class="stat-value">‚Äî</div>
                            <div class="stat-label">Last Update</div>
                        </div>
                        <div class="stat-item">
                            <div id="viewCount" class="stat-value">‚Äî</div>
                            <div class="stat-label">Total Views</div>
                        </div>
                    </div>

                    <div class="controls">
                        <button id="pauseBtn" class="btn">‚è∏Ô∏è Pause</button>
                        <button id="resetBtn" class="btn">üîÑ Reset</button>
                        <button id="shareBtn" class="btn btn-primary">üì§ Share</button>
                    </div>

                    <div class="milestone-section">
                        <h4>üéØ Milestones</h4>
                        <div id="milestones" class="milestone-grid"></div>
                        <input id="customMilestone" class="custom-input" placeholder="Add custom milestone (e.g., 75000)" />
                    </div>

                    <div class="history-section">
                        <h4>üìù Activity History</h4>
                        <div id="history" class="history-container"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = "AIzaSyCW77DSG7O7oowEV_iOg0K_wgJjBzM8Lzs";
        
        const CONFIG = {
            maxResults: 10,
            pollInterval: 30000,
            simInterval: 3000,
            defaultMilestones: [1000, 5000, 10000, 25000, 50000, 100000, 250000, 500000, 1000000, 2500000, 5000000]
        };

        let appState = {
            currentChannel: null,
            isPaused: false,
            subscribers: 0,
            realSubs: 0,
            growthRate: 0,
            viewCount: 0,
            milestones: new Set(CONFIG.defaultMilestones),
            triggeredMilestones: new Set(),
            lastApiCall: 0,
            history: [],
            globalOffset: {} // Store per-channel random offsets
        };

        // Global state management for consistent counts across users
        const GlobalState = {
            getChannelOffset(channelId, realSubs) {
                if (!appState.globalOffset[channelId]) {
                    // Generate consistent offset based on channel ID
                    const hash = channelId.split('').reduce((a, b) => {
                        a = ((a << 5) - a) + b.charCodeAt(0);
                        return a & a;
                    }, 0);
                    
                    // Create offset between 100-999 based on hash
                    const offset = Math.abs(hash % 900) + 100;
                    appState.globalOffset[channelId] = offset;
                }
                return appState.globalOffset[channelId];
            },
            
            getGlobalSubCount(channelId, realSubs) {
                const offset = this.getChannelOffset(channelId, realSubs);
                // Add time-based fluctuation for realism
                const timeFluctuation = Math.floor((Date.now() / 10000) % 1000);
                return realSubs + offset + timeFluctuation;
            }
        };

        const $ = id => document.getElementById(id);
        const format = num => typeof num === 'number' ? num.toLocaleString() : num;
        
        // Storage helpers
        const saveData = (key, data) => {
            try { localStorage.setItem(key, JSON.stringify(data)); } catch(e) {}
        };
        
        const loadData = key => {
            try { return JSON.parse(localStorage.getItem(key)); } catch(e) { return null; }
        };

        // YouTube API functions
        async function searchChannels(query) {
            const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=channel&maxResults=${CONFIG.maxResults}&q=${encodeURIComponent(query)}&key=${API_KEY}`;
            const response = await fetch(url);
            if (!response.ok) throw new Error('Search failed');
            const data = await response.json();
            return data.items || [];
        }

        async function getChannelDetails(channelIds) {
            const url = `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics&id=${channelIds.join(',')}&key=${API_KEY}`;
            const response = await fetch(url);
            if (!response.ok) throw new Error('API request failed');
            const data = await response.json();
            return data.items || [];
        }

        // UI Functions
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification show';
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 4000);
        }

        function addToHistory(message) {
            const timestamp = new Date().toLocaleTimeString();
            const historyItem = `${timestamp} - ${message}`;
            appState.history.unshift(historyItem);
            
            if (appState.history.length > 50) appState.history.pop();
            
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const historyEl = $('history');
            historyEl.innerHTML = appState.history.map(item => 
                `<div class="history-item">${item}</div>`
            ).join('');
        }

        function updateCounterDisplay() {
            const previousSubs = parseInt($('subCount').textContent.replace(/,/g, '')) || 0;
            const currentSubs = Math.floor(appState.subscribers);
            
            // Animate subscriber count changes
            const subCountEl = $('subCount');
            if (currentSubs !== previousSubs && previousSubs > 0) {
                subCountEl.classList.remove('increase', 'decrease');
                if (currentSubs > previousSubs) {
                    subCountEl.classList.add('increase');
                } else {
                    subCountEl.classList.add('decrease');
                }
                setTimeout(() => subCountEl.classList.remove('increase', 'decrease'), 500);
            }
            
            subCountEl.textContent = format(currentSubs);
            $('growthRate').textContent = appState.growthRate > 0 ? format(Math.round(appState.growthRate)) : '‚Äî';
            $('lastUpdate').textContent = appState.lastApiCall ? new Date(appState.lastApiCall).toLocaleTimeString() : '‚Äî';
            $('viewCount').textContent = appState.viewCount ? format(appState.viewCount) : '‚Äî';
            $('pauseBtn').innerHTML = appState.isPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause';
        }

        function renderMilestones() {
            const container = $('milestones');
            const sortedMilestones = Array.from(appState.milestones).sort((a, b) => a - b);
            
            container.innerHTML = sortedMilestones.map(milestone => {
                const isTriggered = appState.triggeredMilestones.has(milestone);
                const isActive = appState.subscribers >= milestone * 0.9;
                const className = isTriggered ? 'triggered' : isActive ? 'active' : '';
                
                return `<div class="milestone ${className}" onclick="toggleMilestone(${milestone})">${format(milestone)}</div>`;
            }).join('');
        }

        function renderSearchResults(channels) {
            const resultsEl = $('results');
            
            if (channels.length === 0) {
                resultsEl.innerHTML = '<div class="empty-state"><p>No channels found. Try a different search term.</p></div>';
                return;
            }

            resultsEl.innerHTML = channels.map(channel => `
                <div class="channel-card" onclick="loadChannel('${channel.id}', '${channel.title.replace(/'/g, "\\'")}', ${channel.subscriberCount})">
                    <img src="${channel.thumbnail}" alt="${channel.title}" class="channel-avatar" onerror="this.style.display='none'">
                    <div class="channel-info">
                        <h3>${channel.title}</h3>
                        <div class="channel-subs">${format(channel.subscriberCount)} subscribers</div>
                    </div>
                </div>
            `).join('');
        }

        // Core Functions
        async function performSearch() {
            const query = $('searchInput').value.trim();
            if (!query) return;

            $('results').innerHTML = '<div style="text-align: center; padding: 20px;"><div class="loading"></div><br>Searching...</div>';

            try {
                const searchResults = await searchChannels(query);
                const channelIds = searchResults.map(item => item.snippet.channelId);
                const channelDetails = await getChannelDetails(channelIds);

                const channels = channelDetails.map(channel => ({
                    id: channel.id,
                    title: channel.snippet.title,
                    thumbnail: channel.snippet.thumbnails?.medium?.url || '',
                    subscriberCount: parseInt(channel.statistics?.subscriberCount || 0)
                }));

                channels.sort((a, b) => b.subscriberCount - a.subscriberCount);
                renderSearchResults(channels);
                
            } catch (error) {
                $('results').innerHTML = `<div class="empty-state"><p>‚ùå Error: ${error.message}</p></div>`;
            }
        }

        async function loadChannel(channelId, channelTitle, subscriberCount) {
            appState.currentChannel = { id: channelId, title: channelTitle };
            
            // Get global subscriber count with consistent offset
            const globalSubs = GlobalState.getGlobalSubCount(channelId, subscriberCount);
            appState.subscribers = globalSubs;
            appState.realSubs = subscriberCount;
            appState.triggeredMilestones.clear();
            
            $('channelName').textContent = channelTitle;
            
            addToHistory(`Loaded ${channelTitle}`);
            updateCounterDisplay();
            renderMilestones();
            
            // Load saved data if available
            const savedData = loadData(`channel_${channelId}`);
            if (savedData) {
                appState.triggeredMilestones = new Set(savedData.triggered || []);
                appState.growthRate = savedData.growthRate || 0;
                renderMilestones();
            }
            
            await pollChannelData(true);
        }

        async function pollChannelData(force = false) {
            if (!appState.currentChannel) return;
            
            const now = Date.now();
            if (!force && (now - appState.lastApiCall) < CONFIG.pollInterval) return;

            try {
                const [channelData] = await getChannelDetails([appState.currentChannel.id]);
                const newSubCount = parseInt(channelData?.statistics?.subscriberCount || 0);
                const viewCount = parseInt(channelData?.statistics?.viewCount || 0);
                
                if (newSubCount !== appState.realSubs && appState.realSubs > 0) {
                    const timeDiff = now - appState.lastApiCall;
                    const subDiff = newSubCount - appState.realSubs;
                    appState.growthRate = (subDiff / timeDiff) * 3600000; // per hour
                    
                    // Update global subscriber count
                    const globalSubs = GlobalState.getGlobalSubCount(appState.currentChannel.id, newSubCount);
                    appState.subscribers = globalSubs;
                    
                    addToHistory(`Updated: ${format(globalSubs)} subs (${subDiff > 0 ? '+' : ''}${format(subDiff)} real)`);
                }
                
                appState.realSubs = newSubCount;
                appState.viewCount = viewCount;
                appState.lastApiCall = now;
                
                saveData(`channel_${appState.currentChannel.id}`, {
                    triggered: Array.from(appState.triggeredMilestones),
                    growthRate: appState.growthRate,
                    lastUpdate: now
                });
                
                updateCounterDisplay();
                
            } catch (error) {
                addToHistory(`API error: ${error.message}`);
            }
        }

        function simulateGrowth() {
            if (appState.isPaused || !appState.currentChannel) return;
            
            const baseRate = Math.max(appState.growthRate || 1, 0.5);
            const timeMultiplier = CONFIG.simInterval / 3600000; // Convert to hours
            const variance = (Math.random() - 0.5) * 0.6; // ¬±30% variance
            const spike = Math.random() < 0.03 ? Math.random() * 3 : 0; // 3% chance of bigger spike
            
            let growth = baseRate * timeMultiplier * (1 + variance + spike);
            
            // More realistic fluctuations - occasional drops
            if (Math.random() < 0.08) growth *= -(Math.random() * 0.3); // 8% chance of small drop
            
            // Ensure minimum movement for visual appeal
            if (Math.abs(growth) < 0.1) {
                growth = Math.random() < 0.5 ? 0.1 : -0.1;
            }
            
            const previousSubs = appState.subscribers;
            appState.subscribers = Math.max(0, appState.subscribers + growth);
            
            // Keep global consistency
            if (appState.currentChannel) {
                const expectedGlobal = GlobalState.getGlobalSubCount(appState.currentChannel.id, appState.realSubs);
                const drift = Math.abs(appState.subscribers - expectedGlobal);
                
                // Gradually pull back towards expected global value if drifting too far
                if (drift > 2000) {
                    const pullback = (expectedGlobal - appState.subscribers) * 0.1;
                    appState.subscribers += pullback;
                }
            }
            
            checkMilestones();
            updateCounterDisplay();
        }

        function checkMilestones() {
            appState.milestones.forEach(milestone => {
                if (!appState.triggeredMilestones.has(milestone) && appState.subscribers >= milestone) {
                    appState.triggeredMilestones.add(milestone);
                    
                    const message = `üéâ ${appState.currentChannel.title} reached ${format(milestone)} subscribers!`;
                    showNotification(message);
                    addToHistory(`Milestone: ${format(milestone)}`);
                    
                    // Browser notification
                    if (Notification.permission === 'granted') {
                        new Notification('Milestone Reached!', { body: message });
                    }
                    
                    renderMilestones();
                }
            });
        }

        function toggleMilestone(milestone) {
            if (appState.milestones.has(milestone)) {
                appState.milestones.delete(milestone);
                appState.triggeredMilestones.delete(milestone);
            } else {
                appState.milestones.add(milestone);
            }
            renderMilestones();
        }

        function togglePause() {
            appState.isPaused = !appState.isPaused;
            addToHistory(appState.isPaused ? 'Simulation paused' : 'Simulation resumed');
            updateCounterDisplay();
        }

        function resetMilestones() {
            if (!appState.currentChannel) return;
            if (!confirm('Reset all milestones for this channel?')) return;
            
            appState.triggeredMilestones.clear();
            addToHistory('Milestones reset');
            renderMilestones();
        }

        async function shareChannel() {
            if (!appState.currentChannel) return;
            
            const shareData = {
                title: `${appState.currentChannel.title} Live Sub Count`,
                text: `Currently at ${format(Math.floor(appState.subscribers))} subscribers!`,
                url: `${window.location.origin}${window.location.pathname}?channel=${appState.currentChannel.id}`
            };
            
            try {
                if (navigator.share) {
                    await navigator.share(shareData);
                } else {
                    await navigator.clipboard.writeText(shareData.url);
                    showNotification('Share link copied to clipboard!');
                }
                addToHistory('Channel shared');
            } catch (error) {
                console.log('Share failed:', error);
            }
        }

        function exportData() {
            if (!appState.currentChannel) return;
            
            const exportData = {
                channel: appState.currentChannel,
                currentCount: Math.floor(appState.subscribers),
                growthRate: appState.growthRate,
                milestones: Array.from(appState.triggeredMilestones),
                history: appState.history,
                timestamp: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `youtube_data_${appState.currentChannel.title.replace(/[^a-z0-9]/gi, '_')}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            addToHistory('Data exported');
        }

        function toggleFullscreen() {
            const counterPanel = document.querySelector('.counter-section').parentElement;
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                counterPanel.requestFullscreen();
            }
        }

        async function requestNotifications() {
            if (!('Notification' in window)) {
                showNotification('Notifications not supported');
                return;
            }
            
            const permission = await Notification.requestPermission();
            if (permission === 'granted') {
                showNotification('Notifications enabled!');
            } else {
                showNotification('Notifications denied');
            }
        }

        // Event Listeners
        $('searchBtn').addEventListener('click', performSearch);
        $('searchInput').addEventListener('keypress', e => e.key === 'Enter' && performSearch());
        $('notifyBtn').addEventListener('click', requestNotifications);
        $('fullscreenBtn').addEventListener('click', toggleFullscreen);
        $('exportBtn').addEventListener('click', exportData);
        $('pauseBtn').addEventListener('click', togglePause);
        $('resetBtn').addEventListener('click', resetMilestones);
        $('shareBtn').addEventListener('click', shareChannel);

        $('customMilestone').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const value = parseInt(this.value.replace(/[^\d]/g, ''));
                if (value > 0) {
                    appState.milestones.add(value);
                    renderMilestones();
                    this.value = '';
                    addToHistory(`Added milestone: ${format(value)}`);
                }
            }
        });

        // Theme cycling
        const themes = [
            { name: 'Purple', bg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' },
            { name: 'Ocean', bg: 'linear-gradient(135deg, #667eea 0%, #5cbdbd 100%)' },
            { name: 'Sunset', bg: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)' },
            { name: 'Forest', bg: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)' }
        ];
        
        let currentTheme = 0;
        $('themeBtn').addEventListener('click', () => {
            currentTheme = (currentTheme + 1) % themes.length;
            document.body.style.background = themes[currentTheme].bg;
            showNotification(`Theme: ${themes[currentTheme].name}`);
        });

        // Initialize
        renderMilestones();
        updateCounterDisplay();
        addToHistory('üöÄ YouTube Live Counter ready!');

        // Start polling and simulation
        setInterval(pollChannelData, CONFIG.pollInterval);
        setInterval(simulateGrowth, CONFIG.simInterval);

        // Load channel from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('channel')) {
            const channelId = urlParams.get('channel');
            getChannelDetails([channelId]).then(channels => {
                if (channels.length > 0) {
                    const channel = channels[0];
                    loadChannel(
                        channel.id, 
                        channel.snippet.title, 
                        parseInt(channel.statistics?.subscriberCount || 0)
                    );
                }
            }).catch(console.error);
        }
    </script>
</body>
</html>
